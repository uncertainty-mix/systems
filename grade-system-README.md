# 成绩管理系统使用指南

## 系统启动

运行 `java -jar grade-system.jar` 启动系统。

## 默认账户

系统提供以下默认账户：

### 老师账户
- 用户名：`teacher`
- 密码：`teacher123`
- 权限：可以管理成绩和课程

### 学生账户
- 用户名：`student`
- 密码：`student123`
- 权限：只能查询成绩和课程

## 交互方式

### 查询、修改、删除操作流程
1. **输入名称搜索**：首先输入课程名称或学生姓名进行搜索
2. **智能处理结果**：
   - 如果只找到一个结果，直接对其进行操作
   - 如果找到多个结果，显示列表让用户输入ID选择具体目标
3. **执行操作**：对选定的目标执行相应操作

## 功能说明

### 老师功能

#### 1. 成绩管理
- **添加成绩**：为学生添加课程成绩
- **修改成绩**：按学生姓名搜索，选择要修改的成绩记录
- **删除成绩**：按学生姓名搜索，选择要删除的成绩记录
- **查询成绩**：查看和搜索成绩信息，支持Excel导出

#### 2. 课程管理
- **添加课程**：创建新的课程
- **修改课程**：按课程名称搜索，选择要修改的课程
- **删除课程**：按课程名称搜索，选择要删除的课程（需要先删除相关成绩）
- **查询课程**：查看和搜索课程信息，支持Excel导出

### 学生功能

#### 1. 查询成绩
- 查看自己的所有成绩
- 按课程查询成绩
- 按学生姓名查询详情
- 支持Excel导出

#### 2. 查询课程
- 查看所有可选课程
- 按课程名称搜索
- 支持Excel导出

## Excel导出功能

查询完成后，系统会询问是否导出Excel文件：
- 输入 `y` 或 `yes` 确认导出
- 文件保存在 `exports/` 目录下
- 文件名包含时间戳，如：`成绩查询结果_20240130_143025.xlsx`

## 系统文件结构

运行jar包后，会在当前目录生成以下文件结构：

```
运行目录/
├── grade-system.jar     # 成绩管理系统
├── data/                # 数据文件目录（自动生成）
│   ├── courses.json     # 课程数据
│   ├── users.json       # 用户数据
│   └── grades_*.json    # 各课程的成绩数据
└── exports/             # Excel导出文件目录（自动生成）
    ├── 成绩查询结果_*.xlsx
    └── 课程查询结果_*.xlsx
```

## 打包和运行

### 编译打包
```bash
mvn clean package
```

### 运行系统
```bash
java -jar target/grade-system.jar
```

## 注意事项

1. **智能搜索**：系统会根据输入的名称进行模糊匹配
2. **结果处理**：单个结果直接操作，多个结果需要选择ID
3. **权限控制**：学生用户无法进行任何增删改操作
4. **数据安全**：删除课程前会检查是否有相关成绩记录
5. **输入验证**：系统会验证所有输入的有效性

## 错误处理

系统包含完善的错误处理机制：
- 输入验证和格式检查
- 重复数据检测
- 搜索结果为空的处理
- 文件读写异常处理
- 用户权限验证

如遇到问题，系统会显示相应的错误信息和解决建议。