# POS收银系统

## 功能特性

- 商品管理（添加、查询、修改、下架）
- 自动ID生成（添加商品时自动分配唯一ID）
- 购买功能（支持批量购买、库存管理）
- 购物记录管理（自动记录每次购买）
- JSON文件持久化存储
- 用户友好的控制台界面

## JSON持久化

系统使用Gson库将商品数据和购物记录持久化到JSON文件中：

### 数据文件
- 商品数据：`data/goods_data.json`
- 购物记录：`data/purchase_records.json`
- 位置：运行目录下的data文件夹

### 商品数据格式
```json
{
  "goods": [
    {
      "id": 1,
      "goodsName": "商品名称",
      "goodsNum": 库存数量,
      "goodsPrice": 价格
    }
  ],
  "googsIndex": 当前商品数量,
  "goodsTotal": 最大商品容量
}
```

### 购物记录格式
```json
[
  {
    "recordId": "PUR1703123456789",
    "purchaseTime": "2024-01-15T14:30:25",
    "items": [
      {
        "goodsId": 1,
        "goodsName": "苹果",
        "quantity": 3,
        "unitPrice": 5.50,
        "subtotal": 16.50
      }
    ],
    "totalAmount": 22.90
  }
]
```

## 系统文件结构

运行jar包后，会在当前目录生成以下文件结构：

```
运行目录/
├── pos-system.jar       # POS收银系统
└── data/                # 数据文件目录（自动生成）
    ├── goods_data.json  # 商品数据
    └── purchase_records.json # 购物记录
```

## 购物记录功能

### 自动记录
- 每次完成购买后自动生成购物记录
- 记录包含购买时间、商品详情、总金额
- 自动分配唯一的记录ID

### 查看记录
- 查看所有购物记录
- 查看最近10条记录
- 详细显示每条记录的商品信息

### 数据持久化
- 购物记录自动保存到JSON文件
- 系统启动时自动加载历史记录
- 支持大量记录的存储和查询

## 自动保存
系统在以下操作后自动保存数据：
- 添加商品
- 修改商品
- 删除商品
- 购买商品（同时保存购物记录）

## 自动加载
系统启动时自动从JSON文件加载数据，如果文件不存在则使用空数据初始化。

## 运行要求

- Java 8+
- Maven（用于依赖管理）
- Gson 2.10.1（通过Maven自动下载）

## 编译和运行

```bash
# 编译项目
mvn clean package

# 运行POS系统
java -jar target/pos-system.jar
```

## 使用说明

1. 启动程序后，系统会自动加载已保存的商品数据和购物记录
2. 通过菜单选择相应功能：
   - 1: 添加商品（系统自动分配ID）
   - 2: 查询商品
   - 3: 修改商品（不能修改ID）
   - 4: 下架商品
   - 5: 购买商品（自动生成购物记录）
   - 6: 查看购物记录
   - 7: 退出系统
3. 所有数据修改会自动保存到JSON文件
4. 程序退出时会确保数据完整保存

## 商品ID管理

- **自动生成**：添加商品时系统自动分配唯一ID
- **防重复**：系统会检查现有ID，确保新ID不重复
- **不可修改**：商品ID一旦分配就不能修改，保证数据一致性